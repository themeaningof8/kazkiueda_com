# GitHub Actions CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆæ›¸

## æ¦‚è¦

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€Testing Trophyã«åŸºã¥ã„ã¦è¨­è¨ˆã•ã‚ŒãŸGitHub Actionsãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®å…¨ä½“åƒã‚’èª¬æ˜ã—ã¾ã™ã€‚

---

## ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å…¨ä½“æ§‹æˆå›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        GitHub Actions Pipeline                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Trigger: Pull Request / Push to main                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Stage 1: Static Analysis (5åˆ†)            â”‚
        â”‚   â”œâ”€ TypeScript type check                  â”‚
        â”‚   â”œâ”€ Biome lint                             â”‚
        â”‚   â””â”€ Format check                           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼                           â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Stage 2: Security    â”‚    â”‚ Stage 3: Unit Tests  â”‚
        â”‚ & Code Quality (10åˆ†)â”‚    â”‚ (5åˆ†)                â”‚
        â”‚ â”œâ”€ Audit deps        â”‚    â”‚ â”œâ”€ Vitest run        â”‚
        â”‚ â”œâ”€ Circular deps     â”‚    â”‚ â”œâ”€ Coverage report   â”‚
        â”‚ â””â”€ Unused exports    â”‚    â”‚ â””â”€ Upload to Codecov â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                           â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Stage 4: Integration Tests (15åˆ†ãƒ»ä¸¦åˆ—)   â”‚
        â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
        â”‚   â”‚ Matrix Strategy (7 suites)         â”‚    â”‚
        â”‚   â”‚ â”œâ”€ payload-client                  â”‚    â”‚
        â”‚   â”‚ â”œâ”€ posts                           â”‚    â”‚
        â”‚   â”‚ â”œâ”€ server-actions                  â”‚    â”‚
        â”‚   â”‚ â”œâ”€ safe-action                     â”‚    â”‚
        â”‚   â”‚ â”œâ”€ collections-posts               â”‚    â”‚
        â”‚   â”‚ â”œâ”€ collections-users               â”‚    â”‚
        â”‚   â”‚ â””â”€ collections-media               â”‚    â”‚
        â”‚   â”‚                                    â”‚    â”‚
        â”‚   â”‚ Each with:                         â”‚    â”‚
        â”‚   â”‚ â€¢ Docker Postgres                  â”‚    â”‚
        â”‚   â”‚ â€¢ DB migrations                    â”‚    â”‚
        â”‚   â”‚ â€¢ Isolated test environment        â”‚    â”‚
        â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼                           â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Stage 5: Build Test  â”‚    â”‚ Stage 6: E2E Tests   â”‚
        â”‚ (10åˆ†)               â”‚    â”‚ (20åˆ†ãƒ»ä¸¦åˆ—)         â”‚
        â”‚ â”œâ”€ Production build  â”‚    â”‚ Matrix: 5 suites     â”‚
        â”‚ â”œâ”€ Bundle analysis   â”‚    â”‚ â”œâ”€ blog              â”‚
        â”‚ â””â”€ Cache .next/      â”‚    â”‚ â”œâ”€ post-detail       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”œâ”€ accessibility     â”‚
                    â”‚                â”‚ â”œâ”€ preview           â”‚
                    â”‚                â”‚ â””â”€ error-handling    â”‚
                    â”‚                â”‚                      â”‚
                    â”‚                â”‚ Each with:           â”‚
                    â”‚                â”‚ â€¢ Docker Postgres    â”‚
                    â”‚                â”‚ â€¢ Next.js dev server â”‚
                    â”‚                â”‚ â€¢ Playwright browser â”‚
                    â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                           â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Final: CI Success Check                   â”‚
        â”‚   âœ… All stages passed                       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Testing Trophy ãƒãƒƒãƒ”ãƒ³ã‚°

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   E2E Tests     â”‚  Stage 6 (20åˆ†)
                    â”‚   Playwright    â”‚  â€¢ Real browser
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â€¢ User flows
                           â–²            â€¢ Accessibility
                          / \
                         /   \
                        /     \
                       /_______\
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚ Integration     â”‚  Stage 4 (15åˆ†)
                      â”‚ Tests           â”‚  â€¢ Payload API
                      â”‚ Vitest + DB     â”‚  â€¢ Server Actions
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â€¢ Collections
                             â–²
                            / \
                           /   \
                          /     \
                         /_______\
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  Unit Tests     â”‚  Stage 3 (5åˆ†)
                        â”‚  Vitest         â”‚  â€¢ Pure functions
                        â”‚  happy-dom      â”‚  â€¢ Validators
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â€¢ Utils
                               â–²
                              / \
                             /   \
                            /     \
                           /_______\
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚  Static         â”‚  Stage 1 (5åˆ†)
                          â”‚  TS + Biome     â”‚  â€¢ Type check
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â€¢ Lint & Format
```

---

## ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼è©³ç´°

### 1. CI Pipeline (`ci.yml`)

#### ç›®çš„
PRä½œæˆæ™‚ã¨mainãƒ–ãƒ©ãƒ³ãƒã¸ã®pushæ™‚ã«ã€Testing Trophyå…¨å±¤ã‚’å®Ÿè¡Œã—ã¦å“è³ªã‚’ä¿è¨¼

#### å®Ÿè¡Œæ™‚é–“
- åˆè¨ˆ: ç´„40åˆ†ï¼ˆä¸¦åˆ—å®Ÿè¡Œã«ã‚ˆã‚Šæœ€é©åŒ–ï¼‰
- Sequentialæ™‚é–“: ç´„90åˆ† â†’ 40åˆ†ã«çŸ­ç¸®

#### ä¸¦åˆ—å®Ÿè¡Œã«ã‚ˆã‚‹æœ€é©åŒ–

```
Timeline:
0min  â”€â”
       â”œâ”€ Static Analysis (5min)
5min  â”€â”˜
       â”œâ”€â”¬â”€ Security (10min)
       â”‚ â””â”€ Unit Tests (5min)
15min â”€â”´â”€ Integration Tests [7 parallel] (15min)
30min â”€â”¬â”€ Build (10min)
       â””â”€ E2E Tests [5 parallel] (20min)
40min â”€â”€â”€ CI Success âœ…
```

### 2. Deployment Pipeline (`deploy.yml`)

#### ç›®çš„
mainãƒ–ãƒ©ãƒ³ãƒã¸ã®ãƒãƒ¼ã‚¸æ™‚ã«æœ¬ç•ªç’°å¢ƒã¸ãƒ‡ãƒ—ãƒ­ã‚¤

#### ãƒ•ãƒ­ãƒ¼

```
Trigger: Push to main
    â”‚
    â–¼
Pre-deployment Checks (5åˆ†)
    â”‚
    â–¼
Build Production (15åˆ†)
    â”‚
    â–¼
Database Migration (10åˆ†)
    â”œâ”€ Environment: production
    â””â”€ Manual approvalå¯èƒ½
    â”‚
    â–¼
Deploy to Vercel (5åˆ†)
    â”œâ”€ Production deployment
    â””â”€ Comment PR with URL
    â”‚
    â–¼
Health Check (5åˆ†)
    â”œâ”€ Homepage: HTTP 200
    â”œâ”€ Blog: HTTP 200
    â””â”€ API: HTTP 200/404
    â”‚
    â–¼
Notify Status
    â”œâ”€ Success â†’ Log + (Optional: Slack)
    â””â”€ Failure â†’ Alert
```

#### å®‰å…¨æ©Ÿæ§‹

1. **Concurrencyåˆ¶å¾¡**: åŒæ™‚ãƒ‡ãƒ—ãƒ­ã‚¤é˜²æ­¢
   ```yaml
   concurrency:
     group: production-deployment
     cancel-in-progress: false
   ```

2. **Environmentä¿è­·**: æœ¬ç•ªç’°å¢ƒã¯æ‰‹å‹•æ‰¿èªå¯èƒ½
   ```yaml
   environment:
     name: production
   ```

3. **Health Check**: ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã®è‡ªå‹•æ¤œè¨¼

### 3. PR Preview (`pr-preview.yml`)

#### ç›®çš„
PRæ¯ã«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç’°å¢ƒã‚’ä½œæˆã—ã€ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ãŒå®Ÿéš›ã®å‹•ä½œã‚’ç¢ºèªå¯èƒ½ã«

#### ãƒ•ãƒ­ãƒ¼

```
Trigger: PR opened/updated
    â”‚
    â–¼
Build Preview (10åˆ†)
    â”‚
    â–¼
Deploy to Vercel Preview
    â”œâ”€ Alias: pr-{number}.kazkiueda.com
    â””â”€ Comment PR with links
    â”‚
    â–¼
Smoke Tests (5åˆ†)
    â”œâ”€ Homepage check
    â”œâ”€ Blog check
    â””â”€ Update PR comment
```

#### PRæ¯ã®ç’°å¢ƒåˆ†é›¢

```yaml
concurrency:
  group: preview-${{ github.event.pull_request.number }}
  cancel-in-progress: true  # æ–°ã—ã„commitã§å¤ã„ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«
```

### 4. Scheduled Maintenance (`scheduled-maintenance.yml`)

#### ç›®çš„
é€±æ¬¡ã§ã‚³ãƒ¼ãƒ‰å“è³ªãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ç›£è¦–

#### ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
```yaml
schedule:
  - cron: '0 0 * * 1'  # æ¯é€±æœˆæ›œæ—¥ 9:00 JST
```

#### å®Ÿè¡Œå†…å®¹

```
Weekly Monday 9:00 JST
    â”‚
    â”œâ”€ Dependency Check (10åˆ†)
    â”‚  â”œâ”€ Outdated packages
    â”‚  â”œâ”€ Security audit
    â”‚  â””â”€ Circular deps
    â”‚
    â”œâ”€ Code Quality (10åˆ†)
    â”‚  â”œâ”€ Duplication check
    â”‚  â””â”€ Unused exports
    â”‚
    â”œâ”€ Coverage Report (20åˆ†)
    â”‚  â”œâ”€ Run all tests
    â”‚  â””â”€ Upload to Codecov
    â”‚
    â”œâ”€ Performance Benchmark (15åˆ†)
    â”‚  â””â”€ Run perf tests
    â”‚
    â”œâ”€ Database Health (5åˆ†)
    â”‚  â””â”€ Check prod DB
    â”‚
    â””â”€ Summary Report
       â””â”€ Generate report + Notify
```

---

## ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥

### 1. ä¾å­˜é–¢ä¿‚ã‚­ãƒ£ãƒƒã‚·ãƒ¥

```yaml
- name: Cache dependencies
  uses: actions/cache@v4
  with:
    path: |
      ~/.bun/install/cache
      node_modules
    key: ${{ runner.os }}-bun-${{ hashFiles('**/bun.lockb') }}
    restore-keys: |
      ${{ runner.os }}-bun-
```

**åŠ¹æœ**: ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚é–“ 3åˆ† â†’ 30ç§’

### 2. Playwrightãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥

```yaml
- name: Cache Playwright browsers
  uses: actions/cache@v4
  with:
    path: ~/.cache/ms-playwright
    key: ${{ runner.os }}-playwright-${{ hashFiles('**/bun.lockb') }}
```

**åŠ¹æœ**: ãƒ–ãƒ©ã‚¦ã‚¶ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚é–“ 2åˆ† â†’ 10ç§’

### 3. ãƒ“ãƒ«ãƒ‰æˆæœç‰©ã‚­ãƒ£ãƒƒã‚·ãƒ¥

```yaml
- name: Cache build
  uses: actions/cache@v4
  with:
    path: .next
    key: ${{ runner.os }}-build-${{ github.sha }}
```

**åŠ¹æœ**: E2Eãƒ†ã‚¹ãƒˆã§ãƒ“ãƒ«ãƒ‰å†åˆ©ç”¨å¯èƒ½

---

## ç’°å¢ƒå¤‰æ•°ç®¡ç†

### ç’°å¢ƒåˆ¥ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ

| ç’°å¢ƒ | ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ | ç”¨é€” |
|------|--------------|------|
| Test | `TEST_` | CIãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ |
| Preview | `PREVIEW_` | PRãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ |
| Production | `PRODUCTION_` | æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤ |

### å¿…é ˆã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ

```yaml
# Testç’°å¢ƒ
TEST_DATABASE_URL
TEST_PAYLOAD_SECRET
TEST_PAYLOAD_PREVIEW_SECRET

# Previewç’°å¢ƒ
PREVIEW_DATABASE_URL
PREVIEW_PAYLOAD_SECRET
PREVIEW_PAYLOAD_PREVIEW_SECRET

# Productionç’°å¢ƒ
PRODUCTION_DATABASE_URL
PRODUCTION_PAYLOAD_SECRET
PRODUCTION_PAYLOAD_PREVIEW_SECRET
NEXT_PUBLIC_SERVER_URL
S3_BUCKET
S3_ACCESS_KEY_ID
S3_SECRET_ACCESS_KEY
S3_REGION
S3_ENDPOINT

# Vercel
VERCEL_TOKEN
VERCEL_ORG_ID
VERCEL_PROJECT_ID

# Optional
CODECOV_TOKEN
SLACK_WEBHOOK
```

---

## ã‚³ã‚¹ãƒˆæœ€é©åŒ–

### 1. Matrix Strategyã«ã‚ˆã‚‹ä¸¦åˆ—åŒ–

**Before**: 7 integration tests Ã— 15åˆ† = 105åˆ†
**After**: 7 testsä¸¦åˆ—å®Ÿè¡Œ = 15åˆ†

**ç¯€ç´„**: 90åˆ† Ã— GitHub Actionsæ–™é‡‘

### 2. ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°

**ä¾å­˜é–¢ä¿‚**: 3åˆ† â†’ 30ç§’ï¼ˆ2.5åˆ†ç¯€ç´„ Ã— å®Ÿè¡Œå›æ•°ï¼‰
**Playwright**: 2åˆ† â†’ 10ç§’ï¼ˆ1.8åˆ†ç¯€ç´„ Ã— å®Ÿè¡Œå›æ•°ï¼‰

### 3. æ—©æœŸå¤±æ•—ï¼ˆFail Fastï¼‰

Static Analysisï¼ˆ5åˆ†ï¼‰ã§å¤±æ•— â†’ æ®‹ã‚Š35åˆ†ã®ã‚¸ãƒ§ãƒ–ã‚’ã‚¹ã‚­ãƒƒãƒ—

---

## ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã¨ã‚¢ãƒ©ãƒ¼ãƒˆ

### 1. GitHub Actions Dashboard

- ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œæ™‚é–“ã®ãƒˆãƒ¬ãƒ³ãƒ‰
- æˆåŠŸç‡ã®ç›£è¦–
- ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã®ç‰¹å®š

### 2. Codecovãƒ¬ãƒãƒ¼ãƒˆ

- ã‚«ãƒãƒ¬ãƒƒã‚¸ã®æ¨ç§»
- PRæ¯ã®ã‚«ãƒãƒ¬ãƒƒã‚¸å¤‰åŒ–
- ã‚«ãƒãƒ¬ãƒƒã‚¸ä½ä¸‹æ™‚ã®ã‚¢ãƒ©ãƒ¼ãƒˆ

### 3. Slacké€šçŸ¥ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

```yaml
- name: Slack notification
  uses: 8398a7/action-slack@v3
  with:
    status: ${{ job.status }}
    webhook_url: ${{ secrets.SLACK_WEBHOOK }}
```

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºç­–

#### 1. E2Eãƒ†ã‚¹ãƒˆãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ

**åŸå› **: ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ãŒé…ã„
**è§£æ±ºç­–**:
```yaml
- name: Start Next.js server
  run: |
    # å¾…æ©Ÿæ™‚é–“ã‚’å»¶é•·
    sleep 10 â†’ sleep 15
```

#### 2. Integration ãƒ†ã‚¹ãƒˆã§DBæ¥ç¶šã‚¨ãƒ©ãƒ¼

**åŸå› **: Docker Composeã®ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ãŒä¸ååˆ†
**è§£æ±ºç­–**:
```yaml
healthcheck:
  interval: 1s
  timeout: 5s
  retries: 30  # ãƒªãƒˆãƒ©ã‚¤å›æ•°ã‚’å¢—åŠ 
```

#### 3. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡ãŒä½ã„

**åŸå› **: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼ãŒé »ç¹ã«å¤‰ã‚ã‚‹
**è§£æ±ºç­–**:
```yaml
# restore-keysã‚’è¿½åŠ 
restore-keys: |
  ${{ runner.os }}-bun-
```

#### 4. ãƒ“ãƒ«ãƒ‰ãŒãƒ¡ãƒ¢ãƒªä¸è¶³

**åŸå› **: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®runnerãŒãƒ¡ãƒ¢ãƒªä¸è¶³
**è§£æ±ºç­–**:
```yaml
runs-on: ubuntu-latest-4-cores  # ã‚ˆã‚Šå¤§ããªrunner
```

---

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›®æ¨™ã¨å®Ÿç¸¾

| ã‚¹ãƒ†ãƒ¼ã‚¸ | ç›®æ¨™ | ç¾åœ¨ | çŠ¶æ…‹ |
|---------|------|------|------|
| Static Analysis | 5åˆ† | 5åˆ† | âœ… |
| Security | 10åˆ† | 10åˆ† | âœ… |
| Unit Tests | 5åˆ† | 5åˆ† | âœ… |
| Integration | 15åˆ† | 15åˆ† | âœ… |
| Build | 10åˆ† | 10åˆ† | âœ… |
| E2E | 20åˆ† | 20åˆ† | âœ… |
| **Total (ä¸¦åˆ—)** | **40åˆ†** | **40åˆ†** | âœ… |
| **Total (é€æ¬¡)** | - | 90åˆ† | - |

**æœ€é©åŒ–ç‡**: 55% (90åˆ† â†’ 40åˆ†)

---

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã®ä¿è­·

- GitHub Secretsã‚’ä½¿ç”¨
- ç’°å¢ƒåˆ¥ã«åˆ†é›¢
- æœ€å°æ¨©é™ã®åŸå‰‡

### 2. ä¾å­˜é–¢ä¿‚ã®ç›£æŸ»

```yaml
- name: Audit dependencies
  run: bun pm audit
```

### 3. SASTï¼ˆStatic Application Security Testingï¼‰

```yaml
# ä»Šå¾Œè¿½åŠ å¯èƒ½
- name: Run Snyk
  uses: snyk/actions/node@master
```

### 4. ç’°å¢ƒã®åˆ†é›¢

- Testç’°å¢ƒ: éš”é›¢ã•ã‚ŒãŸDocker DB
- Previewç’°å¢ƒ: å°‚ç”¨DB
- Productionç’°å¢ƒ: Environmentä¿è­·

---

## ä»Šå¾Œã®æ”¹å–„æ¡ˆ

### 1. Visual Regression Testing

```yaml
- name: Visual regression tests
  uses: lost-pixel/lost-pixel@v3
```

### 2. Lighthouse CI

```yaml
- name: Lighthouse CI
  uses: treosh/lighthouse-ci-action@v10
```

### 3. Dependency Update Automation

```yaml
# Dependabotè¨­å®š
version: 2
updates:
  - package-ecosystem: "npm"
    schedule:
      interval: "weekly"
```

### 4. Container Scanning

```yaml
- name: Run Trivy scanner
  uses: aquasecurity/trivy-action@master
```

---

## ã¾ã¨ã‚

ã“ã®CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¯ã€Testing Trophyã®åŸå‰‡ã«åŸºã¥ã„ã¦è¨­è¨ˆã•ã‚Œã¦ãŠã‚Šã€ä»¥ä¸‹ã®ç‰¹å¾´ãŒã‚ã‚Šã¾ã™:

### âœ… å¼·ã¿

1. **æ®µéšçš„ãªå“è³ªãƒã‚§ãƒƒã‚¯**: Static â†’ Unit â†’ Integration â†’ E2E
2. **ä¸¦åˆ—å®Ÿè¡Œã«ã‚ˆã‚‹é«˜é€ŸåŒ–**: 90åˆ† â†’ 40åˆ†ï¼ˆ55%å‰Šæ¸›ï¼‰
3. **ç’°å¢ƒåˆ†é›¢**: Test/Preview/Production
4. **å®‰å…¨ãªãƒ‡ãƒ—ãƒ­ã‚¤**: æ‰‹å‹•æ‰¿èªã€Health Checkã€Rollbackå¯èƒ½
5. **ç¶™ç¶šçš„ãªç›£è¦–**: é€±æ¬¡ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã€ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°

### ğŸ“Š ãƒ¡ãƒˆãƒªã‚¯ã‚¹

- **ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™**: 75% (lines), 80% (functions)
- **CIå®Ÿè¡Œæ™‚é–“**: 40åˆ†
- **ãƒ‡ãƒ—ãƒ­ã‚¤é »åº¦**: 1æ—¥è¤‡æ•°å›å¯èƒ½
- **Mean Time to Recovery**: < 10åˆ†ï¼ˆRollbackæ™‚ï¼‰

### ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã®è¨­å®š
2. Vercelé€£æº
3. Codecové€£æº
4. æœ¬ç•ªç’°å¢ƒã§ã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
5. ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†é–‹å§‹
